(function(){function g(){this.name="PlayListEndException"}var d="https://apex.oracle.com/pls/apex/open-thinks/youdao/music/api/list";var c="https://apex.oracle.com/pls/apex/open-thinks/youdao/music/api/lyric/";var f=this.youdao=this.youdao||{};var b=f.music={YOUDAO_PATH:"http://xue.youdao.com",options:{listSel:"",playSel:"",lyricSel:""},init:function(h){b.options=h;b.playlist.render(d);b.player.init($(b.options.playSel)[0])}};var e=b.playlist={currntPlay:0,listLength:0,loop:true,items:[],navNext:null,navPrevious:null,render:function(h){e.navNext=null;e.navPrevious=null;e.items=[];e.fetch(h)},getCurrentPlay:function(){return e.items[e.currntPlay]},next:function(){if(e.currntPlay+1>=e.listLength){if(!e.loop){throw new g()}else{e.currntPlay=0;return}}e.currntPlay=e.currntPlay+1},fetch:function(h){$.getJSON(h,function(i){if(i.next){e.navNext=i.next.$ref}if(i.previous){e.navPrevious=i.previous.$ref}if(i.items){e.items=i.items}e.updateUI()})},updateUI:function(){var i=e.items;e.listLength=i.length;var h=$(b.options.listSel+" .content");var j=$(b.options.listSel+" .nav");h.empty();j.empty();if(e.navPrevious){j.append('<button name="PP">&lt;</button>')}if(e.navNext){j.append('<button name="PN">&gt;</button>')}$.each(e.items,function(k,l){$('<a data-index="'+k+'" href="javascript:void(0)">'+l.name+"</a>").appendTo(h)});$("a",h).unbind("click").click(function(){var k=$(this).data("index");e.currntPlay=parseInt(k);a.play()});$("button",j).unbind("click").click(function(){var l=$(this).attr("name");var k=(l=="PN"?e.navNext:e.navPrevious);e.render(k)})}};var a=b.player={audio:new Audio(),init:function(h){a.audio=h;a.audio.onended=function(){try{e.next();a.play()}catch(i){console.log("Play end.")}}},play:function(){a.audio.src=b.YOUDAO_PATH+e.getCurrentPlay().audio_url;$('a[data-index!="'+e.currntPlay+'"]').removeClass("audio-list-active");$('a[data-index="'+e.currntPlay+'"]').addClass("audio-list-active");a.audio.play();var h=c+e.getCurrentPlay().id;$.get(h,function(i){$(b.options.lyricSel).html(i)})}}})();(function(){var b=this.youdao=this.youdao||{};var a=b.musicSrc=[]})();